<template>
    <div class="mainview">
        <div  id="cesiumContainer" style="height: 100%;width: 100%">
        </div>
        <div class="leftdiv" id="left1" style="width:22%;flex-direction: row;transition:width 1s"  >
            <Box title="鄠邑秦保要闻" style="flex:1">
                 <div id="boxlist1" class="boxlist" slot="content" >
                    <ul class="list1">
                        <li >
                            <div class="data fl" style="float:left;margin-right:15px;width:15%">
                                <h1>8</h1>
                                <h2>2021-9</h2>
                            </div>
                            <div class="news-right-con fr" style="text-align:left;color: black;width:95%">
                                <a href="javascript:void (0);" onclick="leftVal = (screen.width - 600) / 2;topVal = (screen.height - 650) / 2; window.open('https://view.inews.qq.com/a/20210908A0FJMC00','_blank','width=950,height=550,toolbars=yes,resizable=yes,scrollbars=yes,left='+leftVal+',top='+topVal)"  style="text-decoration:none;color:black">
                                    <h1 style="overflow:hidden;text-overflow:ellipsis">检察长韩柏超一行莅临西安市鄠邑区督导检查秦岭保护公益诉讼工作</h1>
                                    <p style="overflow:hidden;text-overflow:ellipsis;font-size: 17px">2021年9月8日下午，西安市人民检察院党组成员、副检察长韩柏超</p>
                                </a>
                            </div>
                        </li>
                        <li >
                            <div class="data fl" style="float:left;margin-right:15px;width:15%">
                                <h1>10</h1>
                                <h2>2021-9</h2>
                            </div>
                            <div class="news-right-con fr" style="text-align:left;color: black;width:95%">
                                <a href="javascript:void (0);" onclick="leftVal = (screen.width - 600) / 2;topVal = (screen.height - 650) / 2; window.open('https://www.sohu.com/a/489108475_121123744','_blank','width=950,height=550,toolbars=yes,resizable=yes,scrollbars=yes,left='+leftVal+',top='+topVal)"  style="text-decoration:none;color:black">
                                    <h1 style="overflow:hidden;text-overflow:ellipsis">鄠邑!最新的西安市秦岭生态环境保护规划出炉</h1>
                                    <p style="overflow:hidden;text-overflow:ellipsis;font-size: 17px">最新的西安市秦岭生态环境保护规划出炉，这次骊山片区也划入保护区，</p>
                                </a>
                            </div>
                        </li>

                        <li >
                            <div class="data fl" style="float:left;margin-right:15px;width:15%">
                                <h1>3</h1>
                                <h2>2021-9</h2>
                            </div>
                            <div class="news-right-con fr" style="text-align:left;color: black;width:95%">
                                <a href="javascript:void (0);" onclick="leftVal = (screen.width - 600) / 2;topVal = (screen.height - 650) / 2; window.open('https://baijiahao.baidu.com/s?id=1709844688946738961&wfr=spider&for=pc','_blank','width=950,height=550,toolbars=yes,resizable=yes,scrollbars=yes,left='+leftVal+',top='+topVal)"  style="text-decoration:none;color:black">
                                    <h1 style="overflow:hidden;text-overflow:ellipsis">鄠邑区秦岭保护智慧管控中心搭建起防汛指挥平台</h1>
                                    <p style="overflow:hidden;text-overflow:ellipsis;font-size: 17px">近期降雨频繁，降水过程长、强度大，鄠邑区果断决策，在区秦岭生态环境</p>
                                </a>
                            </div>
                        </li>
                        <li >
                            <div class="data fl" style="float:left;margin-right:15px;width:15%">
                                <h1>2</h1>
                                <h2>2021-9</h2>
                            </div>
                            <div class="news-right-con fr" style="text-align:left;color: black;width:95%">
                                <a href="javascript:void (0);" onclick="leftVal = (screen.width - 600) / 2;topVal = (screen.height - 650) / 2; window.open('https://baijiahao.baidu.com/s?id=1709786676013122267&wfr=spider&for=pc','_blank','width=950,height=550,toolbars=yes,resizable=yes,scrollbars=yes,left='+leftVal+',top='+topVal)"  style="text-decoration:none;color:black">
                                    <h1 style="overflow:hidden;text-overflow:ellipsis">鄠邑区秦岭太平峪又现羚牛,这次一家三口都来了</h1>
                                    <p style="overflow:hidden;text-overflow:ellipsis;font-size: 17px">健壮憨萌，阔步向前，寓意着“同享新生活”十四运吉祥物之一羚牛“羚羚”又来了</p>
                                </a>
                            </div>
                        </li>
                        <li >
                            <div class="data fl" style="float:left;margin-right:15px;width:15%">
                                <h1>1</h1>
                                <h2>2021-9</h2>
                            </div>
                            <div class="news-right-con fr" style="text-align:left;color: black;width:95%">
                                <a href="javascript:void (0);" onclick="leftVal = (screen.width - 600) / 2;topVal = (screen.height - 650) / 2; window.open('https://www.sohu.com/a/487107483_121124614','_blank','width=950,height=550,toolbars=yes,resizable=yes,scrollbars=yes,left='+leftVal+',top='+topVal)"  style="text-decoration:none;color:black">
                                    <h1 style="overflow:hidden;text-overflow:ellipsis">秦岭中段北坡地区又拍到野生动物啦!</h1>
                                    <p style="overflow:hidden;text-overflow:ellipsis;font-size: 17px">近两月来，鄠邑区秦岭保护局太平国有生态林场工作人员用红</p>
                                </a>
                            </div>
                        </li>
                        <li >
                            <div class="data fl" style="float:left;margin-right:15px;width:15%">
                                <h1>9</h1>
                                <h2>2021-9</h2>
                            </div>
                            <div class="news-right-con fr" style="text-align:left;color: black;width:95%">
                                <a href="javascript:void (0);" onclick="leftVal = (screen.width - 600) / 2;topVal = (screen.height - 650) / 2; window.open('https://www.sohu.com/a/488848440_735537','_blank','width=950,height=550,toolbars=yes,resizable=yes,scrollbars=yes,left='+leftVal+',top='+topVal)"  style="text-decoration:none;color:black">
                                    <h1 style="overflow:hidden;text-overflow:ellipsis">总面积5904k㎡,秦岭生态环境保护再加码</h1>
                                    <p style="overflow:hidden;text-overflow:ellipsis;font-size: 17px">近日，西安市自然资源和规划局发布关于公示《西安市秦岭生态环境保护规划》的说</p>
                                </a>
                            </div>
                        </li>                        <li >
                        <div class="data fl" style="float:left;margin-right:15px;width:15%">
                            <h1>23</h1>
                            <h2>2021-5</h2>
                        </div>
                        <div class="news-right-con fr" style="text-align:left;color: black;width:95%">
                            <a href="javascript:void (0);" onclick="leftVal = (screen.width - 600) / 2;topVal = (screen.height - 650) / 2; window.open('https://baijiahao.baidu.com/s?id=1700506671885406240&wfr=spider&for=pc','_blank','width=950,height=550,toolbars=yes,resizable=yes,scrollbars=yes,left='+leftVal+',top='+topVal)"  style="text-decoration:none;color:black">
                                <h1 style="overflow:hidden;text-overflow:ellipsis">秦岭生物多样性实现恢复性增长</h1>
                                <p style="overflow:hidden;text-overflow:ellipsis;font-size: 17px">（记者 申东昕）5月20日，记者从陕西省林业局获悉：通过多年努力</p>
                            </a>
                        </div>
                    </li>
                        <li >
                            <div class="data fl" style="float:left;margin-right:15px;width:15%">
                                <h1>14</h1>
                                <h2>2021-8</h2>
                            </div>
                            <div class="news-right-con fr" style="text-align:left;color: black;width:95%">
                                <a href="javascript:void (0);" onclick="leftVal = (screen.width - 600) / 2;topVal = (screen.height - 650) / 2; window.open('https://baijiahao.baidu.com/s?id=1681665803844360376&wfr=spider&for=pc','_blank','width=950,height=550,toolbars=yes,resizable=yes,scrollbars=yes,left='+leftVal+',top='+topVal)"  style="text-decoration:none;color:black">
                                    <h1 style="overflow:hidden;text-overflow:ellipsis">保护大秦岭有了千里眼 鄠邑区秦岭保护总站监控指挥中心建成投用</h1>
                                    <p style="overflow:hidden;text-overflow:ellipsis;font-size: 17px">为切实做好秦岭保护工作，鄠邑区按照适用、实用的原则，立足于做好常态</p>
                                </a>
                            </div>
                        </li>
                        <li >
                            <div class="data fl" style="float:left;margin-right:15px;width:15%">
                                <h1>16</h1>
                                <h2>2021-7</h2>
                            </div>
                            <div class="news-right-con fr" style="text-align:left;color: black;width:95%">
                                <a href="javascript:void (0);" onclick="leftVal = (screen.width - 600) / 2;topVal = (screen.height - 650) / 2; window.open('https://baijiahao.baidu.com/s?id=1705427853342238913&wfr=spider&for=pc','_blank','width=950,height=550,toolbars=yes,resizable=yes,scrollbars=yes,left='+leftVal+',top='+topVal)"  style="text-decoration:none;color:black">
                                    <h1 style="overflow:hidden;text-overflow:ellipsis">用科技力量助力秦岭保护 西安鄠邑区“一站三中心”投入使用</h1>
                                    <p style="overflow:hidden;text-overflow:ellipsis;font-size: 17px">日前，西安市鄠邑区秦岭违建警示教育中心、秦岭保护智...</p>
                                </a>
                            </div>
                        </li>

                    </ul>
                </div>
            </Box>
            <div class="leftdivbutton" @click="hide(1)"></div>
        </div>
        <div class="rightdiv"  id="left2" style="width:22%;flex-direction: row;transition:width 1s">


           <Box title="新闻视频" style="flex:1;">
               <div id="boxlist2" class="boxlist" slot="content" >
               <!--     <ul class="list1">
                        <li  v-for="(danwei,index) in namelist.huyinews"
                             v-bind:key="index"  v-on:click="ListClick(danwei)">
                            {{danwei.name}}
                        </li>
                    </ul>-->
<!--                   <div class='demo'>-->
<!--                       <video-player class="video-player vjs-custom-skin"-->
<!--                                     ref="videoPlayer"-->
<!--                                     :playsinline="true"-->
<!--                                     :options="playerOptions">-->
<!--                       </video-player>-->
<!--                   </div>-->
<!--                </div>-->

                   <div class="demo">
                       <div v-for="(item,i) in list" :key="i" style="margin-bottom:2px">
                           <video :id="'myVideo'+item.id" class="video-js">
                               <source :src="item.src" type="video/mp4">
                           </video>
                           <h2>{{item.name}}</h2>
                       </div>
                   </div>
               </div>
         </Box>

           <div class="rightdivbutton" @click="hide(2)"></div>
        </div>
    </div>
</template>

<script>
    import Box from "../../components/common/er/box";
    import barSthjzs from "../../components/charts/bar/stzkpj/barSthjzs.vue";
    import url from  "../../assets/er/images/initw.jpg"
    import video1 from "../../assets/video/鄠邑金丝猴.mp4"
    import video2 from "../../assets/video/202104191105.mp4"
    import video3 from "../../assets/video/峪口介绍.mp4"
    import ol from "openlayers";



    export default {
        components: {
            Box,
            barSthjzs,
        },
        name: "",
        mounted() {
            this.newscroll("boxlist1");
           // this.newscroll("boxlist2");
            this.initMap(3);
            //this.addwmtsservice();

            // this.zoomtoRangle();
            this.loadQLjson();
            this.loadqlbhdxj();
            this.initVideo();
            // this.qlbhqPointLayer=this.addDTpoints();
           /* var lon=117.286419;
            var lat=31.864436;
            this.addCircleRipple(this.viewer,{ //默认只绘制两个圆圈叠加 如遇绘制多个，请自行源码内添加。
                id:"111",
                lon:lon,
                lat:lat,
                height:500,
                maxR:30000,
                minR:0,//最好为0
                deviationR:500,//差值 差值也大 速度越快
                eachInterval:2000,//两个圈的时间间隔
                imageUrl:"../../assets/er/images/圆.png"
            });*/
            this.QlLayer= new Cesium.CustomDataSource();
            this.qlbhqLayer=new Cesium.CustomDataSource();
            this.qlbhqPointLayer=new Cesium.CustomDataSource();
            this.viewer.dataSources.add( this.QlLayer);
            this.viewer.dataSources.add( this.qlbhqLayer);
            this.viewer.dataSources.add( this.qlbhqPointLayer);
        },
        data() {
            return {
                barSthjzsData: {
                    xAxis: ["q", "w", "ee"],
                    yAxis: [10, 11, 29]
                },
                imageUrl:url,
                bhdtype:1,
                qlbhqLayer: null,
                qlbhqPointLayer: null,
                sydbhqLayer:null,
                sydbhqPointLayer:null,
                QlLayer:null,
                ShanxiLayer:null,

               zrbhdColorArray:["rgba(0,100,0,0.4)","rgba(0,128,0,0.3)",
                    "rgba(50,205,50,0.4)","rgba(144,238,144,0.4)","rgba(250,250,210,0.3)"],
                sydbhqColorArray:["rgba(0,100,255,0.3)","rgba(30,144,255,0.3)","rgba(100,149,237,0.3)",
                "rgba(135,206,250,0.3)","rgba(225,255,255,0.3)","rgba(0,100,255,0.3)","rgba(30,144,255,0.3)","rgba(100,149,237,0.3)",
                "rgba(135,206,250,0.3)","rgba(225,255,255,0.3)","rgba(0,100,255,0.3)","rgba(30,144,255,0.3)","rgba(100,149,237,0.3)",
                "rgba(135,206,250,0.3)","rgba(225,255,255,0.3)"],
                pointscolorAyyay:["#085208","#00ff00","#ffff00","#ff9900","#ff0000"],

                list:[
                    {
                        src:video1,
                        id:0,
                        //../../assets/er/images/熊猫.png
                        pic:"",
                        name:"金丝猴保护区"
                    },
                    {
                        src:video2,
                        id:1,
                        pic:"",
                        name:"别墅整治"
                    },
                    {
                        src:video3,
                        id:2,
                        pic:"",
                        name:"峪道整治"
                    }
                ],


                // playerOptions: {
                //     //播放速度
                //     playbackRates: [0.5, 1.0, 1.5, 2.0],
                //     //如果true,浏览器准备好时开始回放。
                //     autoplay: false,
                //     // 默认情况下将会消除任何音频。
                //     muted: false,
                //     // 导致视频一结束就重新开始。
                //     loop: false,
                //     // 建议浏览器在<video>加载元素后是否应该开始下载视频数据。auto浏览器选择最佳行为,立即开始加载视频（如果浏览器支持）
                //     preload: 'auto',
                //     language: 'zh-CN',
                //     // 将播放器置于流畅模式，并在计算播放器的动态大小时使用该值。值应该代表一个比例 - 用冒号分隔的两个数字（例如"16:9"或"4:3"）
                //     aspectRatio: '16:9',
                //     // 当true时，Video.js player将拥有流体大小。换句话说，它将按比例缩放以适应其容器。
                //     fluid: true,
                //     sources: [{
                //         //类型
                //         type: "video/mp4",
                //         //url地址
                //         src: 'http://img.yopoo.cn/banner_video.mp4'
                //     }],
                //     //你的封面地址  D:\product\sthx\src\assets\images\huyilogo.png
                //     poster: '.../.../src/assets/images/huyilogo.png',
                //     //允许覆盖Video.js无法播放媒体源时显示的默认信息。
                //     notSupportedMessage: '此视频暂无法播放，请稍后再试',
                //     controlBar: {
                //         timeDivider: true,
                //         durationDisplay: true,
                //         remainingTimeDisplay: false,
                //         //全屏按钮
                //         fullscreenToggle: true
                //     }
                // }

            }
        },
        methods: {
            //左右滑动特效
            hide(i) {
                var div1 = document.getElementById("left1");
                var div2 = document.getElementById("left2");
                if (div1.style.width == "22%") {
                    div1.style.width = "0px";
                    div2.style.width = "22%";
                    this.bhdtype = 2;
                } else {
                    div2.style.width = "0px";
                    div1.style.width = "22%";
                    this.bhdtype = 1;
                }
                if (this.bhdtype == 1) {
                    this.viewer.dataSources.add(this.QlLayer);
                    this.viewer.dataSources.add(this.qlbhqLayer);
                    this.viewer.dataSources.add(this.qlbhqPointLayer);
                } else {
                    this.viewer.dataSources.remove(this.QlLayer);
                    this.viewer.dataSources.remove(this.qlbhqLayer);
                    this.viewer.dataSources.remove(this.qlbhqPointLayer);
                }
            },
            //滚动函数，需要搭配div样式使用
            newscroll(divid) {
                var box = document.getElementById(divid);

                function scrollup() {
                    //卷去高度 >= 元素内容总高度 - 元素像素高度，此时滚动到最后一个条目
                    if ((box.scrollHeight - box.clientHeight) - box.scrollTop < 10) {
                        //滚动条距离顶部的值恰好等于list1的高度时，达到滚动临界点，此时将让scrollTop=0,让list1回到初始位置，实现无缝滚动
                        box.scrollTop = 0;
                    } else {
                        box.scrollTop += 10;
                    }
                }

                var scrollMove = setInterval(scrollup, 250);//数值越大，滚动速度越慢
                //鼠标经过时，滚动停止
                box.onmouseover = function () {
                    clearInterval(scrollMove)
                }
                //鼠标离开时，滚动继续
                box.onmouseout = function () {
                    scrollMove = setInterval(scrollup, 250);
                }
            },
            // 初始化地图
            initMap(weidu) {
                if (weidu == 2) {
                    this.map = new ol.Map({
                        controls: ol.control.defaults({attribution: false, zoom: true, rotate: false}).extend([]),
                        target: 'cesiumContainer',
                        view: new ol.View({
                            //extent: [-20026376.39,-20048966.10,20026376.39,20048966.10],
                            projection: this.gProjection,
                            //resolutions: this.gResolutions,
                            center: [12149145.114081362, 4316266.289],
                            zoom: 8
                        })
                    });
                    this.LoadGaoDeMap();
                } else {
                    //设置cesium的home为中国
                    this.viewer = new Cesium.Viewer('cesiumContainer', {
                        // 需要进行可视化的数据源的集合
                        animation: false, // 是否显示动画控件
                        shouldAnimate: true,
                        homeButton: true, // 是否显示Home按钮
                        fullscreenButton: true, // 是否显示全屏按钮
                        baseLayerPicker: false, // 是否显示图层选择控件
                        geocoder: true, // 是否显示地名查找控件
                        timeline: false, // 是否显示时间线控件
                        sceneModePicker: true, // 是否显示投影方式控件
                        navigationHelpButton: false, // 是否显示帮助信息控件
                        infoBox: true, // 是否显示点击要素之后显示的信息
                        requestRenderMode: true, // 启用请求渲染模式
                        scene3DOnly: true, // 每个几何实例将只能以3D渲染以节省GPU内存
                        sceneMode: 3, // 初始场景模式 1 2D模式 2 2D循环模式 3 3D模式  Cesium.SceneMode
                        fullscreenElement: document.body, // 全屏时渲染的HTML元素 暂时没发现用处
                        //加载单张图片为影像服务(给球表面贴一张图)
                        imageryProvider: new Cesium.SingleTileImageryProvider({
                            url: this.imageUrl
                        })
                    })

                    this.viewer.camera.flyTo({
                        destination: Cesium.Cartesian3.fromDegrees(108.593,34.003, 100000),
                        orientation: {
                            // heading: Cesium.Math.toRadians(-180.0), // 方向
                            // pitch: Cesium.Math.toRadians(-20.0),// 倾斜角度
                            roll: 0,
                        }
                    });
                    // Cesium.Camera.DEFAULT_VIEW_RECTANGLE = Cesium.Rectangle.fromDegrees(90, -20, 110, 90);
                }
            },
            //添加地图服务
            addwmtsservice() {
                var provider = new Cesium.WebMapTileServiceImageryProvider({
                    url: 'http://10.61.10.133:6080/arcgis/rest/services/hjjczz2/2/MapServer/tile/{TileMatrix}/{TileRow}/{TileCol}',
                    layer: 'hjjczz2_2',
                    style: 'default',
                    tileMatrixSetID: 'default028mm',
                    format: 'image/png',
                    maximumLevel: 8,
                    tileMatrixLabels: ['0', '1', '2', '3', '4', '5', '6', '7'] // 对应2.4中的tileMatrix Identifier属性
                });
                this.viewer.imageryLayers.addImageryProvider(provider);
            },
            //缩放到陕西
            zoomtoRangle() {
                var center = Cesium.Cartesian3.fromDegrees(105, 31.4, 0);
                var center2 = Cesium.Cartesian3.fromDegrees(111, 39.3, 0);
                var rec = Cesium.Rectangle.fromCartesianArray([center, center2]);
                var boundingSphere = Cesium.BoundingSphere.fromRectangle3D(rec);
                boundingSphere.radius = boundingSphere.radius * 1.0;
                this.viewer.camera.flyToBoundingSphere(boundingSphere, {
                    duration: 3,
                    maximumHeight: 1000,
                    offset: {
                        heading: Cesium.Math.toRadians(0.0),
                        pitch: Cesium.Math.toRadians(-60),
                        range: 0.0
                    }
                });
            },
            //添加秦岭json文件
            async loadQLjson() {
                let json = require("../../assets/js/geojson/huyi.json");
                //设置geojson线条、填充样式。load方法是个promise，用异步处理。
                let res = await Cesium.GeoJsonDataSource.load(json);
                this.SetSymbol2(res,this.QlLayer);
            },
            // 添加陕西县级geojson
            async loadqlbhdxj() {
                let json = require("../../assets/js/geojson/sxxj.json");
                var geojsonOptions = {
                    clampToGround: true
                };
                let dataPromise = await Cesium.GeoJsonDataSource.load(json, geojsonOptions);
              //  this.viewer.dataSources.add(dataPromise);
                this.SetSymbol(dataPromise, this.sydbhqColorArray, "_NAME", "_市",this.qlbhqLayer);
                return dataPromise;
            },
            //添加动态点。
            async addDTpoints(){
                let json = require("../../assets/js/geojson/qinlingpoint.json");
                var geojsonOptions = {
                    clampToGround: true
                };
                let dataPromise = await Cesium.GeoJsonDataSource.load(json, geojsonOptions);
                this.addCircleRipple(this.viewer,dataPromise,this.pointscolorAyyay,this.qlbhqPointLayer);
            },

            SetSymbol2(dataSource,layername){
                var neighborhoodEntities = dataSource.entities.values;
                for (var i = 0; i < neighborhoodEntities.length; i++) {
                    var entity = neighborhoodEntities[i];
                    entity.polygon.material=Cesium.Color.fromCssColorString("rgba(255,255,255,0.3)");
                    layername.entities.add(entity);
                }
            },
            //分类设置symbol，数据源，颜色条，labelname，分类的字段。
            SetSymbol(dataSource, colorArray, name, type,layername) {
                var typeArray = [];
                var neighborhoodEntities = dataSource.entities.values;
                for (var i = 0; i < neighborhoodEntities.length; i++) {
                    var entity = neighborhoodEntities[i];
                    if (Cesium.defined(entity.polygon)) {
                        entity.name = entity.properties[name]._value;
                        if (typeArray.indexOf(entity.properties[type]._value) < 0) {
                            typeArray.push(entity.properties[type]._value);
                            //cssColor:值可以是 #ffccdd, rgb(255，255，255)，rgb(255，0，255，0.5)
                            entity.polygon.material = Cesium.Color.fromCssColorString(colorArray[typeArray.length])
                        } else {
                            entity.polygon.material = Cesium.Color.fromCssColorString
                            (colorArray[typeArray.indexOf(entity.properties[type]._value)]);
                        }
                        // Set the polygon material to a random, translucent color.
                        /* entity.polygon.material = Cesium.Color.fromRandom({
                            // red: 0.5,
                            // maximumGreen: 0.9,
                            // minimumBlue: 0.1,
                            alpha: 0.2
                        });*/
                        entity.polygon.outline = false;
                        //entity.polygon.extrudedHeight=1000;

                        // Generate Polygon position,设置标注
                        /*var polyPositions = entity.polygon.hierarchy.getValue(Cesium.JulianDate.now()).positions;
                        //获取多边形中心,以便放置注记
                        var polyCenter = Cesium.BoundingSphere.fromPoints(polyPositions).center;
                        polyCenter = Cesium.Ellipsoid.WGS84.scaleToGeodeticSurface(polyCenter);
                        entity.position = polyCenter;
                        entity.distanceDisplayCondition = new Cesium.DistanceDisplayCondition(1000.0, 300000.0);
                            // 生成注记
                            entity.label = {
                                text: entity.name,
                                showBackground: true,
                                scale: 0.7,
                                horizontalOrigin: Cesium.HorizontalOrigin.CENTER,
                                verticalOrigin: Cesium.VerticalOrigin.BOTTOM,
                                heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,
                                distanceDisplayCondition: new Cesium.DistanceDisplayCondition(1000.0, 300000.0),
                            };*/
                    }
                    layername.entities.add(entity);
                }
            },
            //查询关键字，关键字的字段
            async querydataPromise(name, field) {
                var array = new Object();
                array.type = "FeatureCollection";
                array.features = new Array();
                if (this.bhdtype == 1) {
                    var json = require("../../assets/js/geojson/sxxj.json");
                    for (var i = 0; i < json.features.length; i++) {
                        var feature = json.features[i];
                        if (feature.properties[field] == name) {
                            array.features.push(feature);
                        }
                    }
                } else {

                }
                let res = await Cesium.GeoJsonDataSource.load(array, {
                    stroke: Cesium.Color.BLACK,
                    fill: Cesium.Color.YELLOW.withAlpha(0.2),
                    strokeWidth: 5
                });
                this.viewer.flyTo(res);
                this.viewer.dataSources.add(res);
            },
            //定位到图斑
            ListClick(danwei) {
                 window.open(danwei.link,"_blank", "height=700px,width=700px,top=50%,left=50%,scrollbars=yes,resizable=1,modal=false,alwaysRaised=yes,location=no");
                //window.open(danwei.link,'height='+iHeight+',innerHeight='+iHeight+',width='+iWidth+',innerWidth='+iWidth+',top='+iTop+',left='+iLeft+',toolbar=no,menubar=no,scrollbars=auto,resizeable=no,location=no,status=no');
            },

            //添加动态圈圈方法。
            addCircleRipple(viewer,dataSource,colorAyyay,thislayer){
                var neighborhoodEntities = dataSource.entities.values;
                for (var i = 0; i < neighborhoodEntities.length; i++) {
                    var entity = neighborhoodEntities[i];
                    var data= new Object();
                    if(entity.properties.分级._value>10)
                    {
                        data.maxR=6000;
                        data.minR=0;
                        data.deviationR=200;
                        data.eachInterval=3000;
                        data.color=colorAyyay[0];
                        data.imageUrl='../../assets/er/images/zuo.png';
                    }else
                    {
                        data.maxR=3000;
                        data.minR=0;
                        data.deviationR=100;
                        data.eachInterval=3000;
                        data.color=colorAyyay[2];
                        data.imageUrl='../../assets/er/images/zuo.png';
                    }
                    var r1=data.minR,r2=data.minR;
                    function changeR1() { //这是callback，参数不能内传
                        r1=r1+data.deviationR;
                        if(r1>=data.maxR){
                            r1=data.minR;
                        }

                        return r1;
                    }
                    function changeR2() {
                        r2=r2+data.deviationR;
                        if(r2>=data.maxR){
                            r2=data.minR;
                        }
                        return r2;
                    }
                    entity.billboard=null;
                    entity.label={
                        text: ''+entity.properties.分级._value,
                        showBackground: false,
                        scale: 0.7,
                        horizontalOrigin: Cesium.HorizontalOrigin.CENTER,
                        verticalOrigin: Cesium.VerticalOrigin.BOTTOM,
                        heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,
                        distanceDisplayCondition: new Cesium.DistanceDisplayCondition(1000.0, 300000.0),
                    };
                    entity.ellipse={
                        semiMinorAxis :new Cesium.CallbackProperty(changeR1,false),
                        semiMajorAxis :new Cesium.CallbackProperty(changeR1,false),
                        height:data.height,
                        material:new Cesium.ImageMaterialProperty({
                            image:data.imageUrl,
                            repeat:new Cesium.Cartesian2(1.0, 1.0),
                            transparent:true,
                            color:new Cesium.CallbackProperty(function () {
                                var alp=1-r1/data.maxR;
                                //return Cesium.Color.WHITE.withAlpha(alp)
                               return Cesium.Color.fromCssColorString( data.color).withAlpha(alp) //entity的颜色透明 并不影响材质，并且 entity也会透明哦
                            },false)
                        })
                    };
                    setTimeout(function () {
                        entity.ellipse={
                            semiMinorAxis :new Cesium.CallbackProperty(changeR2,false),
                            semiMajorAxis :new Cesium.CallbackProperty(changeR2,false),
                            height:data.height,
                            material:new Cesium.ImageMaterialProperty({
                                image:data.imageUrl,
                                repeat:new Cesium.Cartesian2(1.0, 1.0),
                                transparent:true,
                                color:new Cesium.CallbackProperty(function () {
                                    var alp=1;
                                    alp=1-r2/data.maxR;
                                    return Cesium.Color.fromCssColorString(data.color).withAlpha(alp)
                                },false)
                            })
                        }
                    },data.eachInterval)
                    thislayer.entities.add(entity);
                }

               /* viewer.entities.add({
                    id:data.id,
                    name:"",
                    position:Cesium.Cartesian3.fromDegrees(data.lon,data.lat,data.height),
                    ellipse : {
                        semiMinorAxis :new Cesium.CallbackProperty(changeR1,false),
                        semiMajorAxis :new Cesium.CallbackProperty(changeR1,false),
                        height:data.height,
                        material:new Cesium.ImageMaterialProperty({
                            image:data.imageUrl,
                            repeat:new Cesium.Cartesian2(1.0, 1.0),
                            transparent:true,
                            color:new Cesium.CallbackProperty(function () {
                                var alp=1-r1/data.maxR;
                                return Cesium.Color.RED.withAlpha(alp)  //entity的颜色透明 并不影响材质，并且 entity也会透明哦
                            },false)
                        })
                    }
                });
                setTimeout(function () {
                    viewer.entities.add({
                        name:"",
                        position:Cesium.Cartesian3.fromDegrees(data.lon,data.lat,data.height),
                        ellipse : {
                            semiMinorAxis :new Cesium.CallbackProperty(changeR2,false),
                            semiMajorAxis :new Cesium.CallbackProperty(changeR2,false),
                            height:data.height,
                            material:new Cesium.ImageMaterialProperty({
                                image:data.imageUrl,
                                repeat:new Cesium.Cartesian2(1.0, 1.0),
                                transparent:true,
                                color:new Cesium.CallbackProperty(function () {
                                    var alp=1;
                                    alp=1-r2/data.maxR;
                                    return Cesium.Color.RED.withAlpha(alp)
                                },false)
                            })
                        }
                    });
                },data.eachInterval)*/
            },
            //页面视频播放
            initVideo() {
                //初始化视频方法 循环列表获取每个视频的id
                this.list.map((item,i)=>{
                    let myPlayer = this.$video('myVideo'+item.id, {
                        //确定播放器是否具有用户可以与之交互的控件。没有控件，启动视频播放的唯一方法是使用autoplay属性或通过Player API。
                        controls: true,
                        //自动播放属性,muted:静音播放
                        // autoplay: "muted",
                        //如果为true，浏览器准备好开始回放
                        autoplay:false,
                        //建议浏览器是否应在<video>加载元素后立即开始下载视频数据。
                        preload: "auto",
                        //默认情况下将会消除任何音频
                        muted:false,
                        //设置视频播放器的显示宽度（以像素为单位）
                        width: "700px",
                        //设置视频播放器的显示高度（以像素为单位）
                        height: "320px",
                        // 将播放器置于流畅模式，并在计算播放器的动态大小时使用该值。值应该代表一个比例 - 用冒号分隔的两个数字（例如"16:9"或"4:3"）
                        aspectRatio: "16:9",
                        // 当true时，Video.js player将拥有流体大小。换句话说，它将按比例缩放以适应其容器。
                        fluid: true,
                        //允许覆盖Video.js无法播放媒体源时显示的默认信息。
                        notSupportedMessage: '此视频暂无法播放，请稍后再试',
                        //封面图   src/assets/images/JCZX.png
                        poster:item.pic,
                        controlBar: {
                            timeDivider: true,
                            durationDisplay: true,
                            remainingTimeDisplay: false,
                            //全屏按钮
                            fullscreenToggle: true
                        }
                    });
                })

            }

        }
    }

</script>

<style lang="scss" scoped>

    .list1{
        min-height:235px;
    }
    .leftdivbutton{
        position:absolute;top:10%;right:-60px;height: 80px;width:80px;
        background-color:#d800d8;
        background: url("../../assets/er/images/熊猫.png");
        background-size:100% 100%;
    }
    .rightdivbutton{
        position:absolute;top:80%;left:-80px;
        height: 80px;width:80px;background-color:#d800d8;
        background: url("../../assets/er/images/鱼.png");
        background-size:100% 100%;
    }
    .boxlist{
        margin-top: 10px;
        width: 100%;
        height:90%;
        overflow:hidden;
        padding-left: 2px;
        padding-right: 5px;
        box-sizing: border-box;
        transition:scrollTop 1s;
        ul{
            li{
                font-size: 1.2em;
                margin-top: 15px;
                box-sizing:border-box;
                text-align: center;
                color: #eee;
                white-space:nowrap;
                overflow:hidden;
                text-overflow:ellipsis;
                width:100%;
                cursor: pointer;
            }
            li:hover{
                color: #72dbd3;
            }
        }
    }
    .list1{
        min-height:235px;
    }
    /*.demo{*/
    /*    display: inline-block;*/
    /*    width: 600px;*/
    /*    height: 338px;*/
    /*    text-align: center;*/
    /*    line-height: 100px;*/
    /*    border: 1px solid transparent;*/
    /*    border-radius: 4px;*/
    /*    overflow: hidden;*/
    /*    background: #fff;*/
    /*    position: relative;*/
    /*    box-shadow: 0 1px 1px rgba(0, 0, 0, .2);*/
    /*    margin-right: 4px;*/
    /*}*/

    /*.demo:hover{*/
    /*    display: block;*/
    /*}*/

</style>